# 103 — Страница объектов мониторинга (objects.html)

## Файл

| Файл | Назначение |
|---|---|
| `pages/objects.html` | Страница управления объектами мониторинга |

## Назначение

Страница для просмотра, фильтрации и групповых операций над объектами мониторинга (HLS / MPEG-TS потоками). Рассчитана на работу с большим количеством объектов.

Связанные требования: `docs/101_object-set.md`

## Структура страницы

```
┌─────────────────────────────────────────────────────────┐
│  Sidebar │  Header: заголовок + кнопки действий         │
│  (72px)  │──────────────────────────────────────────────│
│          │  Фильтры (поиск, группа, тег, кнопки)       │
│          │──────────────────────────────────────────────│
│          │  Bulk Toolbar (появляется при выборе ≥1)     │
│          │──────────────────────────────────────────────│
│          │  Таблица объектов                            │
│          │  ┌─ ☐ │ Название │ URL │ Группы │ Теги ─┐   │
│          │  │ ☐  │ TV Ch 1  │ ... │ Adm,Op │ HLS   │   │
│          │  │ ...│          │     │        │       │   │
│          │  └────────────────────────────────────────┘   │
│          │  Пагинация: ← 1 2 3 ... 18 →               │
└─────────────────────────────────────────────────────────┘

+ Контекстное меню (ПКМ на строке)
+ Модальное окно подтверждения удаления
```

## 1. Header

| Элемент | Описание |
|---|---|
| Заголовок | «Объекты мониторинга» (h2, 32px, 700) |
| Подзаголовок | «Управление потоками HLS / MPEG-TS» (15px, text-secondary) |
| Кнопка «Экспорт списка» | btn-secondary |
| Кнопка «+ Добавить объект» | btn-primary |

## 2. Фильтры (.filters-section)

Панель фильтрации над таблицей. Сетка: `grid-template-columns: 2fr 1fr 1fr 1fr`.

| Фильтр | Тип | Описание |
|---|---|---|
| Поиск | `<input>` текстовое поле | Поиск по имени объекта или URL |
| Группа | Кастомный dropdown с чекбоксами | Множественный выбор групп. По умолчанию: «Все группы». При выборе текст кнопки обновляется на список выбранных через запятую |
| Тег | Кастомный dropdown с чекбоксами | Множественный выбор тегов. По умолчанию: «Все теги». Аналогичное поведение |
| Кнопки | «Сбросить» (secondary) + «Применить» (primary) | Прижаты к правому нижнему углу ячейки |

### Значения фильтра «Группа»

- Administrators
- Operators
- Engineers
- Guests

### Значения фильтра «Тег»

- HLS
- MPEG-TS
- Live
- VOD

### UX-поведение фильтр-дропдаунов

- Клик по кнопке — открывает/закрывает выпадающий список
- Одновременно открыт только один фильтр-дропдаун (взаимное закрытие)
- Клик по чекбоксу внутри списка **не закрывает** дропдаун (stopPropagation)
- Клик в любом месте за пределами дропдауна — закрывает его
- Текст кнопки обновляется динамически: без выбора — «Все группы»/«Все теги», при выборе — перечисление через запятую

## 3. Bulk Toolbar (.bulk-toolbar)

Панель групповых действий. Скрыта по умолчанию (`display: none`), появляется при выборе ≥ 1 строки в таблице с анимацией slideDown.

| Элемент | Описание |
|---|---|
| Счётчик | «Выбрано: N» (accent-primary, 14px, 600) |
| Разделитель | Вертикальная линия 1px x 24px |
| «Изменить группу» | Dropdown с множественным выбором групп + кнопки «Отмена» / «OK» |
| «Изменить теги» | Dropdown с множественным выбором тегов + кнопки «Отмена» / «OK» |
| «Удалить» | btn-danger, открывает модальное окно подтверждения |

### UX-поведение bulk-дропдаунов

- Открытие одного дропдауна закрывает другой
- Клик внутри дропдауна (чекбоксы) **не закрывает** его
- «Отмена» — закрывает дропдаун без действия
- «OK» — закрывает дропдаун (в mock без реального применения)
- Рамка тулбара — accent-primary (зелёная), выделяет панель визуально

### Значения дропдаунов в тулбаре

**Изменить группу:** Administrators, Operators, Engineers, Guests

**Изменить теги:** HLS, MPEG-TS, Live, VOD

## 4. Таблица объектов (.objects-table)

### Столбцы

| # | Столбец | CSS-класс | Описание |
|---|---|---|---|
| 1 | ☐ | `.th-checkbox` / `.td-checkbox` | Чекбокс выбора (48px, center) |
| 2 | Название объекта | `.object-name-cell` | Имя потока (font-weight: 600) |
| 3 | URL | `.object-url-cell` | URL потока (JetBrains Mono, 12px, accent-secondary, ellipsis при переполнении, max-width: 320px) |
| 4 | Группа доступа | `.group-badge` | Бейджи групп (accent-secondary фон/рамка) |
| 5 | Теги | `.tag` | Теги с цветовой кодировкой |

### Цветовая кодировка тегов

| Тег | CSS-класс | Цвет фона | Цвет текста |
|---|---|---|---|
| HLS | `.tag--hls` | rgba(255, 170, 0, 0.1) | accent-warning (#ffaa00) |
| MPEG-TS | `.tag--mpegts` | rgba(0, 204, 255, 0.1) | accent-secondary (#00ccff) |
| Live | `.tag--live` | rgba(0, 255, 136, 0.1) | accent-primary (#00ff88) |
| VOD | (без модификатора) | bg-tertiary | text-secondary |

### Мок-данные (8 строк)

| Название | URL | Группы | Теги |
|---|---|---|---|
| TV Channel 1 - Main Feed | https://stream.example.com/ch1/index.m3u8 | Administrators, Operators | HLS, Live |
| TV Channel 2 - Sports | https://stream.example.com/ch2/index.m3u8 | Operators | HLS, Live |
| Radio Stream - FM 101.5 | udp://239.0.0.10:1234 | Operators, Engineers | MPEG-TS, Live |
| Test Stream - QA | https://staging.example.com/test/index.m3u8 | Engineers, Guests | HLS, Live, VOD |
| Backup Feed - Channel 1 | udp://239.0.0.20:5500 | Administrators | MPEG-TS |
| Dev Environment Stream | https://dev.example.com/stream/index.m3u8 | Engineers | HLS, VOD |
| TV Channel 3 - News 24/7 | https://stream.example.com/ch3/index.m3u8 | Administrators, Guests | HLS, Live |
| IPTV Multicast - Region A | udp://239.1.1.1:8000 | Operators | MPEG-TS, Live |

### Интерактивность таблицы

- **Select All** (чекбокс в заголовке): выделяет/снимает все строки
- **Индивидуальный чекбокс**: выделяет строку, обновляет состояние Select All (checked / indeterminate)
- **Подсветка строки**: выбранные строки получают класс `.selected` (зеленоватый фон)
- **Анимация**: строки появляются с анимацией fadeIn с нарастающей задержкой (0.03s шаг)
- **Hover**: лёгкая подсветка строки (rgba(255,255,255, 0.02))

## 5. Пагинация (.table-footer)

| Элемент | Описание |
|---|---|
| Информация | «Показано 1-8 из 142 объектов» (13px, text-secondary) |
| Кнопки | ← 1 2 3 ... 18 → (page-btn, активная страница — accent-primary фон) |

## 6. Контекстное меню (.context-menu)

Появляется при правом клике (contextmenu) на строке таблицы. Позиционируется по координатам курсора.

| Пункт | ID | Действие |
|---|---|---|
| Изменить группу | `ctxChangeGroup` | Открывает bulk-дропдаун групп |
| Изменить теги | `ctxChangeTags` | Открывает bulk-дропдаун тегов |
| ── разделитель ── | | |
| Удалить | `ctxDelete` | Открывает модальное окно удаления |

### UX-поведение контекстного меню

- Если строка **не выделена** — при ПКМ автоматически снимает выделение с остальных, выделяет текущую строку
- Если строка **уже выделена** — контекстное меню применяется ко всем выделенным строкам
- Закрывается при клике в любом месте

## 7. Модальное окно удаления (.modal-overlay + .modal)

| Элемент | Описание |
|---|---|
| Иконка | `!` на красноватом фоне (56x56px) |
| Заголовок | «Удалить объекты?» |
| Текст | «Вы уверены, что хотите удалить выбранные объекты (N шт.)? Это действие нельзя отменить.» — N подставляется динамически |
| «Отмена» | btn-secondary, закрывает модалку |
| «Удалить» | btn-danger, удаляет выбранные строки из DOM (mock) |

### UX-поведение модалки

- Открывается поверх всего (z-index: 1000) с полупрозрачным оверлеем
- Анимация появления: scale 0.95 → 1
- Закрытие: кнопка «Отмена» или клик по оверлею
- После подтверждения: строки удаляются из таблицы, чекбоксы сбрасываются, тулбар скрывается

## Стилевые параметры

### CSS-переменные (dark theme)

| Переменная | Значение | Назначение |
|---|---|---|
| `--bg-primary` | #0a0e1a | Фон body |
| `--bg-secondary` | #111827 | Фон карточек/таблицы |
| `--bg-tertiary` | #1a2332 | Фон полей ввода/thead |
| `--accent-primary` | #00ff88 | Основной акцент (зелёный) |
| `--accent-secondary` | #00ccff | Вторичный акцент (голубой) |
| `--accent-warning` | #ffaa00 | Предупреждение (оранжевый) |
| `--accent-danger` | #ff3366 | Опасность (красный) |
| `--text-primary` | #e4e8f0 | Основной текст |
| `--text-secondary` | #8b94a8 | Вторичный текст |
| `--border-color` | #1f2937 | Границы |

### Шрифты

| Шрифт | Использование |
|---|---|
| Outfit (300, 400, 600, 700) | Основной UI |
| JetBrains Mono (400, 500, 700) | URL-ячейки, моноширинный текст |

### z-index карта

| z-index | Элемент |
|---|---|
| 0 | body::before (градиентный фон) |
| 1 | .container |
| 50 | Dropdown-меню, фильтр-дропдауны |
| 100 | Sidebar |
| 999 | Контекстное меню |
| 1000 | Модальное окно |

## Подключение

```html
<aside class="sidebar"></aside>
<!-- ... основной контент ... -->
<script src="../components/sidebar.js"></script>
<script>
    // Вся логика страницы в IIFE
    (function () { ... })();
</script>
```

Сайдбар подключается как внешний компонент (`components/sidebar.js` + `components/sidebar.css`). Вся остальная логика — inline-скрипт в конце body.
